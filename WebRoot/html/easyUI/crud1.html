<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<title>Basic DataGrid - jQuery EasyUI Demo</title>

<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="this is my page">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<!--<link rel="stylesheet" type="text/css" href="./styles.css">-->

<link rel="stylesheet" type="text/css"
	href="../../js/jquery-easyui-1.9.4/themes/default/easyui.css">
<link rel="stylesheet" type="text/css"
	href="../../js/jquery-easyui-1.9.4/themes/icon.css">
<link rel="stylesheet" type="text/css"
	href="../../js/jquery-easyui-1.9.4/demo/demo.css">
<script type="text/javascript" src="../../js/jquery-easyui-1.9.4/jquery.min.js"></script>
<script type="text/javascript"
	src="../../js/jquery-easyui-1.9.4/jquery.easyui.min.js"></script>
<script type="text/javascript"
	src="../../js/jquery-easyui-1.9.4/locale/easyui-lang-zh_CN.js"></script>
<script>
	var url;
	function deleteUser() {
		var row = $('#dg').datagrid('getSelected');
		if (row) {
			$.messager.confirm("系统提示", "您确定要删除这条记录吗?", function(r) {
				if (r) {
					$.post('userDelete', {
						delId : row.id
					}, function(result) {
						if (result.success) {
							$.messager.alert("系统提示", "已成功删除这条记录!");
							$("#dg").datagrid("reload");
						} else {
							$.messager.alert("系统提示", result.errorMsg);
						}
					}, 'json');
				}
			});
		}
	}

	function newUser() {
		$("#dlg").dialog('open').dialog('setTitle', '添加用户');
		$('#fm').form('clear');
		url = 'userSave';
	}


	function editUser() {
		var row = $('#dg').datagrid('getSelected');
		if (row) {
			$("#dlg").dialog('open').dialog('setTitle', '编辑用户');
			$('#fm').form('load', row);
			url = 'userSave?id=' + row.id;
		}
	}


	function saveUser() {
		$('#fm').form('submit', {
			url : url,
			onSubmit : function() {
				return $(this).form('validate');
			},
			success : function(result) {
				var result = eval('(' + result + ')');
				if (result.errorMsg) {
					$.messager.alert("系统提示", result.errorMsg);
					return;
				} else {
					$.messager.alert("系统提示", "保存成功");
					$('#dlg').dialog('close');
					$("#dg").datagrid("reload");
				}
			}
		});
	}
</script>

</head>

<body>
	<table id="dg" title="用户管理" class="easyui-datagrid"
		style="width:700px;height:365px" url="userList" toolbar="#toolbar"
		pagination="true" rownumbers="true" fitColumns="true"
		singleSelect="true">
		<thead>
			<tr>
				<th field="id" width="50" hidden="true">编号</th>
				<th field="name" width="50">姓名</th>
				<th field="phone" width="50">电话</th>
				<th field="email" width="50">Email</th>
				<th field="qq" width="50">QQ</th>
			</tr>
		</thead>
	</table>
	<div id="toolbar">
		<a href="javascript:void(0)" class="easyui-linkbutton"
			iconCls="icon-add" plain="true" οnclick="newUser()">添加用户</a> <a
			href="javascript:void(0)" class="easyui-linkbutton"
			iconCls="icon-edit" plain="true" οnclick="editUser()">编辑用户</a> <a
			href="javascript:void(0)" class="easyui-linkbutton"
			iconCls="icon-remove" plain="true" οnclick="deleteUser()">删除用户</a>
	</div>

	<div id="dlg" class="easyui-dialog"
		style="width:400px;height:250px;padding:10px 20px" closed="true"
		buttons="#dlg-buttons">
		<form id="fm" method="post">
			<table cellspacing="10px;">
				<tr>
					<td>姓名：</td>
					<td><input name="name" class="easyui-validatebox"
						required="true" style="width: 200px;"></td>
				</tr>
				<tr>
					<td>联系电话：</td>
					<td><input name="phone" class="easyui-validatebox"
						required="true" style="width: 200px;"></td>
				</tr>
				<tr>
					<td>Email：</td>
					<td><input name="email" class="easyui-validatebox"
						validType="email" required="true" style="width: 200px;"></td>
				</tr>
				<tr>
					<td>QQ：</td>
					<td><input name="qq" class="easyui-validatebox"
						required="true" style="width: 200px;"></td>
				</tr>
			</table>
		</form>
	</div>

	<div id="dlg-buttons">
		<a href="javascript:void(0)" class="easyui-linkbutton"
			iconCls="icon-ok" οnclick="saveUser()">保存</a> <a
			href="javascript:void(0)" class="easyui-linkbutton"
			iconCls="icon-cancel" οnclick="javascript:$('#dlg').dialog('close')">关闭</a>
	</div>

</body>
</html>
